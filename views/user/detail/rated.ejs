<div class="evoluate-block">
  <div class="evoluate-star">
    <div class="evoluate-star-number">
      <h1 class="evoluate-star-number-main">
        <span><%= listcode.stars %></span>/5 <i class="fas fa-star"></i>
      </h1>
      <p><%= listComment.length %> đánh giá</p>
    </div>
    <ul class="evoluate-star-classify">
      <li class="evoluate-star-classify-item">
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <span><%= listCount[4] %></span>
      </li>
      <li class="evoluate-star-classify-item">
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <span><%= listCount[3] %></span>
      </li>
      <li class="evoluate-star-classify-item">
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <span><%= listCount[2] %></span>
      </li>
      <li class="evoluate-star-classify-item">
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <span><%= listCount[1] %></span>
      </li>
      <li class="evoluate-star-classify-item">
        <img src="/public/icon/star-active.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <img src="/public/icon/star-empty.png" alt="" />
        <span><%= listCount[0] %></span>
      </li>
    </ul>
  </div>
  <div class="evoluate-comment">
    <% listComment.map(comment => { %>
    <div class="evoluate-comment-content">
      <div class="evoluate-comment-user">
        <img src="<%= comment.userID.avatar %>" alt="" />
        <div class="evoluate-comment-user-title">
          <%= comment.userID.username %> <span>đã đánh giá</span>
          <% for (let i = 0 ; i < comment.star ; i++) { %>
          <i class="fas fa-star"></i>
          <% } %>
        </div>
      </div>
      <p><%= comment.content %></p>
      <div class="evoluate-comment-content-end">
        <p><%= comment.updatedAt.toLocaleDateString() %></p>
        <% if (user && user.email === comment.userID.email) { %>
        <button
          title="Chỉnh sửa đánh giá"
          data-bs-toggle="modal"
          data-bs-target="#exampleModal"
          onclick="getDataToModal('<%= comment.star %>', '<%= comment.content %>', '<%= comment._id %>')"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            class="bi bi-pencil-fill"
            viewBox="0 0 16 16"
          >
            <path
              style="fill: #888"
              d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"
            />
          </svg>
        </button>
        <% } %>
      </div>
    </div>
    <% }) %>
  </div>
</div>

<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header modal-rated-header">
        <h5 class="modal-title">Chỉnh sửa đánh giá cho <%= listcode.name %></h5>
      </div>
      <div class="modal-body modal-rated-body">
        <div class="modal-rated-star"></div>
        <p class="modal-rated-error">
          Vui lòng thả sao để đánh giá sản phẩm này
        </p>
        <div class="modal-rated-text">
          <p><span>0</span>/100 kí tự</p>
          <textarea
            name=""
            id=""
            rows="3"
            placeholder="Hãy để lại bình luận để đánh giá sản phẩm của chúng tôi"
          ></textarea>
        </div>
      </div>
      <div class="modal-footer modal-rated-footer">
        <button
          type="button"
          class="modal-footer-cancel"
          data-bs-dismiss="modal"
        >
          Hủy bỏ
        </button>
        <button
          type="button"
          class="modal-footer-post"
          onclick="editRate(this, '<%= listcode._id %>')"
        >
          Lưu thay đổi
        </button>
      </div>
    </div>
  </div>
</div>
